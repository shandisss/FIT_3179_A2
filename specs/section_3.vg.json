{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "width": "container",
  "height": 460,
  "autosize": { "type": "fit", "contains": "padding" },
  "title": {
    "text": "Per-capita meat consumption in Malaysia (2014–2020)",
    "subtitle": "Poultry dominates; other meats are comparatively low.",
    "anchor": "start",
    "fontSize": 16,
    "subtitleFontSize": 12
  },
  "data": {
    "url": "https://raw.githubusercontent.com/shandisss/FIT_3179_A2/refs/heads/main/data/MALAY_PKAPITA.csv",
    "format": { "type": "csv" }
  },
  "transform": [
    { "filter": "datum.region == 'Malaysia'" },
    { "filter": "datum.measure_type == 'per_capita'" },
    {
      "calculate": "replace(replace(datum.commodity, ' (Kg)', ''), ' Meat', '')",
      "as": "meat_type"
    }
  ],
  "layer": [    {
      "data": { "values": [ {} ] },
      "mark": {
        "type": "rect",
        "fill": "white",
        "opacity": 0.85,
        "stroke": "#ccc",
        "strokeWidth": 1,
        "cornerRadius": 6
      },
      "encoding": {
        "x": { "value": 275 },
        "x2": { "value": 465 },
        "y": { "value": 160 },
        "y2": { "value": 230 }
      }
    }, {
      "data": {
        "values": [
          {
            "note": "Pork intake remains stable\namong non-Muslim population,\n~2.5× the national average."
          }
        ]
      },
      "mark": {
        "type": "text",
        "align": "left",
        "fontSize": 12,
        "fontWeight": "normal",
        "lineBreak": "\n",
        "color": "#333"
      },
      "encoding": {
        "x": { "value": 290 },
        "y": { "value": 180 },
        "text": { "field": "note" }
      }
    },
    { "params": [
    {
      "name": "seriesSelect",
      "select": { "type": "point", "fields": ["meat_type"] },
      "bind": "legend"
    }
  ],
      "mark": { "type": "line", "point": true },
      "encoding": {
        "x": {
          "field": "year",
          "type": "quantitative",
          "axis": { "title": "Year", "tickMinStep": 1, "format": "d", "grid": false }
        },
        "y": {
          "field": "value",
          "type": "quantitative",
          "axis": { "title": "kg per person" }
        },
        "color": {
          "field": "meat_type",
          "type": "nominal",
          "title": "Meat type"
        },
        "opacity": {
          "condition": { "param": "seriesSelect", "value": 1 },
          "value": 0.2
        },
        "tooltip": [
          { "field": "meat_type", "title": "Meat type" },
          { "field": "year", "type": "quantitative", "title": "Year" },
          { "field": "value", "type": "quantitative", "title": "kg per person", "format": ".1f" },
          { "field": "flag", "title": "Note" }
        ]
      }
    }
  ],
  "config": {
    "view": { "stroke": null }
  }
}
